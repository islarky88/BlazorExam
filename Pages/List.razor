@page "/list"

@using BlazorExam.Data
@using Newtonsoft.Json

@inject IJSRuntime jsRuntime


<h1>Saved Items</h1>

    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Temp. (C)</th>
                <th>Temp. (C)</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var Item in Data)
            {
                <tr class="pointer">
                    <td>@Item.Id</td>
                    <td>@Item.Title</td>
                    <td>@Item.UserId</td>
                </tr>
            }
        </tbody>
    </table>


@code {

    List<JsonData> Data = new List<JsonData>();

    private async Task FetchSavedData(string Type) 
    {
      
        var Response = await jsRuntime.InvokeAsync<string>("FetchSavedItems", "Todos");

        Console.WriteLine(Response);

        Data = JsonConvert.DeserializeObject<List<JsonData>>(Response);

          Console.WriteLine(Data);


        Console.WriteLine("hello from list mounted");
        StateHasChanged();
      
    } 

    protected override async Task OnAfterRenderAsync(bool FirstRender)
    {

      if (FirstRender)
      {

        await FetchSavedData("Todos");

      }
    }
}
